(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5773],{81616:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(47344),o=(0,a.zeroX)(1337..toString(16)),i=(0,a.zeroX)(8997..toString(16)),r=(0,a.zeroX)(80001..toString(16)),l=(0,a.zeroX)(137..toString(16)),s={development:{chainId:o,chainName:"Localhost development",nativeCurrency:{name:"Ethereum",symbol:"ETH",decimals:18},rpcUrls:["http://localhost:8545"],blockExplorerUrls:[""],iconUrls:["https://s2.coinmarketcap.com/static/img/coins/64x64/3890.png"]},mumbai:{chainId:r,chainName:"Polygon Testnet Mumbai",nativeCurrency:{name:"Matic",symbol:"MATIC",decimals:18},rpcUrls:["https://matic-mumbai.chainstacklabs.com","https://rpc-endpoints.superfluid.dev/mumbai"],blockExplorerUrls:["https://mumbai.polygonscan.com/"],iconUrls:["https://s2.coinmarketcap.com/static/img/coins/64x64/3890.png"]},mainnet:{chainId:l,chainName:"Polygon Mainnet",nativeCurrency:{name:"Matic",symbol:"MATIC",decimals:18},rpcUrls:["https://polygon-rpc.com"],blockExplorerUrls:["https://polygonscan.com/"],iconUrls:["https://s2.coinmarketcap.com/static/img/coins/64x64/3890.png"]},returnConfig:e=>e===o||e===i?s.development:e===r?s.mumbai:e===l?s.mainnet:s.development};t.default=s},23660:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.MetaMask=t.zeroX=void 0;var r=n(47344);Object.defineProperty(t,"zeroX",{enumerable:!0,get:function(){return r.zeroX}}),t.MetaMask=i(n(98445))},98445:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,o)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return o(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useWallet=t.WalletProvider=t.WalletContext=void 0;const l=i(n(67294)),s=n(47347),c=r(n(81616)),d=e=>{const t=e.replace("0x","");return parseInt(t,16).toString()};t.WalletContext=(0,l.createContext)({});t.WalletProvider=({children:e,nodeUri:n,correctNetworkId:a,externalChainConfig:o})=>{var i;const r=d(a),u=(0,l.useRef)({}),[m,p]=(0,l.useState)(""),[h,v]=(0,l.useState)(""),[w,g]=(0,l.useState)(""),[f,b]=(0,l.useState)(!0),k=o||c.default,y=async e=>{(e=>!Object.keys(k).some((t=>"returnConfig"!==t&&k[t].chainId===e)))(e)?(v(r),g(a),b(!1)):(v(d(e)),g(e))};(0,l.useEffect)((()=>{f||_()}),[f]),(0,l.useEffect)((()=>{var e;(async()=>{var e,t;try{const n=await(null===(t=null===(e=null===window||void 0===window?void 0:window.ethereum)||void 0===e?void 0:e.request)||void 0===t?void 0:t.call(e,{method:"eth_chainId"})),a=d(n);v(a),y(n)}catch(n){console.error(n.message)}})(),null===(e=null===window||void 0===window?void 0:window.ethereum)||void 0===e||e.on("chainChanged",(e=>{y(e)}))}),[]),(0,l.useEffect)((()=>{(async()=>{var e;null===(e=null===window||void 0===window?void 0:window.ethereum)||void 0===e||e.on("accountsChanged",(e=>{e&&e.length>0?p(s.ethers.utils.getAddress(e[0])):(p(""),console.log("No Account found!"))}))})()}),[]);(0,l.useEffect)((()=>{(()=>{let e={};window.ethereum?e=new s.ethers.providers.Web3Provider(window.ethereum):window.web3?e=new s.ethers.providers.Web3Provider(window.web3):(console.log("No Web3, defaulting to HTTPProvider"),e=new s.ethers.providers.JsonRpcProvider(n)),u.current=e})()}),[]),(0,l.useEffect)((()=>{var e;(null===(e=u.current)||void 0===e?void 0:e.listAccounts)&&(async()=>{var e;const t=await(null===(e=u.current)||void 0===e?void 0:e.listAccounts());p((null==t?void 0:t.length)?s.ethers.utils.getAddress(t[0]):"")})()}),[null===(i=u.current)||void 0===i?void 0:i.listAccounts]);const _=async()=>{var e,t,n,a;if(w)try{await(null===(t=null===(e=null===window||void 0===window?void 0:window.ethereum)||void 0===e?void 0:e.request)||void 0===t?void 0:t.call(e,{method:"wallet_switchEthereumChain",params:[{chainId:w}]})),b(!0)}catch(o){if(4902===o.code)try{const e=k.returnConfig(w);await(null===(a=null===(n=null===window||void 0===window?void 0:window.ethereum)||void 0===n?void 0:n.request)||void 0===a?void 0:a.call(n,{method:"wallet_addEthereumChain",params:[e]}))||console.log(`Chain ${h} added successfully!`)}catch(i){console.error(i)}console.error(o)}},C=()=>null!==u.current,E={walletAddress:m,loginMetamask:async()=>{try{await(async()=>{var e,t;try{const n=await(null===(t=null===(e=null===window||void 0===window?void 0:window.ethereum)||void 0===e?void 0:e.request)||void 0===t?void 0:t.call(e,{method:"eth_requestAccounts"}));return p(s.ethers.utils.getAddress(n[0])),n}catch(n){return await Promise.reject(n)}})()}catch(e){console.error(e)}},getProvider:()=>u.current,logout:()=>{p("")},switchChainsOrRegisterSupportedChain:_,checkIsLogged:async()=>{var e,t;if(!C()||!(null===(e=u.current)||void 0===e?void 0:e.listAccounts))return!1;const n=await(null===(t=u.current)||void 0===t?void 0:t.listAccounts());return Boolean(null==n?void 0:n.length)},isAvailable:C,isChainCorrect:f};return l.default.createElement(t.WalletContext.Provider,{value:E},e)};t.useWallet=()=>(0,l.useContext)(t.WalletContext)},47344:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zeroX=void 0,t.zeroX=function(e=""){const{valid:t,output:a}=n(e,/^(?:0x)*([a-f0-9]+)$/i,"zeroXTransformer");return(t?"0x":"")+a};const n=(e,t,n)=>{if("string"!=typeof e)throw new Error(`[${n}] Expected string, input type: ${typeof e}`);const a=e.match(t);return a?{valid:!0,output:a[1]}:{valid:!1,output:e}}},40322:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var a=n(41426);const o=()=>({nodeUri:"https://matic-mumbai.chainstacklabs.com",gatewayUri:"https://defi.v2.gateway.mumbai.nevermined.rocks",faucetUri:"https://faucet.rinkeby.nevermined.rocks",verbose:!0,gatewayAddress:"0x5838B5512cF9f12FE9f2beccB20eb47211F9B0bc",graphHttpUri:"https://api.thegraph.com/subgraphs/name/nevermined-io/common",marketplaceAuthToken:a.AuthToken.fetchMarketplaceApiTokenFromLocalStorage().token,marketplaceUri:"https://defi.v2.marketplace-api.mumbai.nevermined.rocks",artifactsFolder:`${location.protocol}//${location.host}/contracts`})},64223:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>x,contentTitle:()=>N,default:()=>S,frontMatter:()=>E,metadata:()=>A,toc:()=>M});var a=n(87462),o=n(67294),i=n(3905),r=n(91262),l=n(41402),s=n.n(l),c=n(35790),d=n(46605),u=n(41426),m=n(23660),p=n(76798),h=n(82169);var v=n(40322);const w=(0,p.CY)("demo",{demo:"demo_Zn5S",demo__container:"demo__container_XKdI",demo__detail:"demo__detail_XQyo",demo__ddo:"demo__ddo_uikf",demo__buy:"demo__buy_dGjE"}),g=()=>{const{sdk:e,isLoadingSDK:t}=u.Catalog.useNevermined();return o.createElement(o.Fragment,null,o.createElement(p.AH,null,o.createElement(p.II,{className:w("detail"),variants:["bold"]},"Is Loading SDK:"),o.createElement(p.II,{className:w("detail")},t?"Yes":"No")),o.createElement(p.AH,null,o.createElement(p.II,{variants:["bold"],className:w("detail")},"Is SDK Avaialable:"),o.createElement(p.II,{className:w("detail")},e&&Object.keys(e).length>0?"Yes":"No")))},f=e=>{let{ddo:t}=e;return o.createElement(o.Fragment,null,o.createElement(p.AH,null,o.createElement(p.II,{className:w("detail"),variants:["bold"]},"Asset ",t.id.slice(0,10),"...:")),o.createElement(p.II,{className:w("ddo"),variants:["detail"]},JSON.stringify(t)))},b=e=>{let{onPublish:t}=e;const{assets:n}=u.Catalog.useNevermined();return o.createElement(o.Fragment,null,o.createElement(p.wg,{type:"secondary",onClick:t,disabled:!Object.keys(n).length},"mint"))},k=e=>{let{ddo:t}=e;const{assets:n,account:a,isLoadingSDK:i,subscription:r,sdk:l}=u.Catalog.useNevermined(),{walletAddress:s}=m.MetaMask.useWallet(),[c,d]=(0,o.useState)(!1),[h,v]=(0,o.useState)(!1),[g,f]=(0,o.useState)("");(0,o.useEffect)((()=>{(async()=>{d(await a.isNFT1155Holder(t.id,s)),f(await l.assets.owner(t.id))})()}),[s,h]);return o.createElement(p.AH,{className:w("buy")},c?o.createElement(p.wg,{type:"secondary",onClick:async()=>{console.log(t.id),await n.downloadNFT(t.id)},disabled:i},"Download NFT"):g!==s?o.createElement(p.wg,{type:"secondary",onClick:async()=>{a.isTokenValid()||await a.generateToken();const e=await(0,u.getCurrentAccount)(l),n=await r.buySubscription(t.id,e,g,1,1155);v(Boolean(n))},disabled:i},"buy"):o.createElement("span",null,"The owner cannot buy, please change the account to buy the NFT asset"))},y=()=>{const{loginMetamask:e,walletAddress:t}=m.MetaMask.useWallet();return o.createElement(p.AH,null,o.createElement(p.II,{variants:["bold"],className:w("detail")},"Wallet address:"),o.createElement(p.II,null,t),!t&&o.createElement(p.wg,{type:"secondary",onClick:e},"Connect To MM"))},_=e=>{let{gatewayAddress:t}=e;const{isLoadingSDK:n,sdk:a,account:i}=u.Catalog.useNevermined(),{publishNFT1155:r}=u.AssetService.useAssetPublish(),{walletAddress:l}=m.MetaMask.useWallet(),[p,h]=(0,o.useState)({});c.Logger.setLevel(3);const v={main:{name:"",files:[{index:0,contentType:"application/json",url:"https://github.com/nevermined-io/docs/blob/master/docs/architecture/specs/metadata/examples/ddo-example.json"}],type:"dataset",author:"",license:"",dateCreated:(new Date).toISOString(),price:""}};return o.createElement("div",{className:w("container")},o.createElement(g,null),o.createElement(y,null),l&&!p.id&&o.createElement(b,{onPublish:async()=>{try{const e=await(0,u.getCurrentAccount)(a),n=((e,t,n)=>{const a=new Map;let o=[];1===e.length&&0===e[0].split&&(o=[{name:n,split:100,walletAddress:n}]);let i=0;if(o.forEach((e=>{if(e.split&&e.split>0){const n=(t*e.split/100).toFixed();a.set(e.walletAddress,d.default.from(+n)),i+=e.split}})),!a.has(n)){const e=+(t*(100-i)/100).toFixed();a.set(n,d.default.from(e))}return a})([],100,e.getId()),o=new(s())(n),l={royaltyKind:u.RoyaltyKind.Standard,scheme:(0,u.getRoyaltyScheme)(a,u.RoyaltyKind.Standard),amount:0};i.isTokenValid()||await i.generateToken();const c=await r({gatewayAddress:t,assetRewards:o,metadata:v,nftAmount:1,preMint:!0,cap:100,royaltyAttributes:l,erc20TokenAddress:"0x2058A9D7613eEE744279e3856Ef0eAda5FCbaA7e"});h(c)}catch(e){console.log("error",e)}}}),!n&&(null==p?void 0:p.id)&&o.createElement(o.Fragment,null,o.createElement(f,{ddo:p}),o.createElement(k,{ddo:p})))},C=()=>{var e;const t=(0,v.e)();return t.web3Provider="undefined"!=typeof window?null==(e=window)?void 0:e.ethereum:new h.r("https://matic-mumbai.chainstacklabs.com"),o.createElement(u.Catalog.NeverminedProvider,{config:t,verbose:!0},o.createElement(u.AssetService.AssetPublishProvider,null,o.createElement(m.MetaMask.WalletProvider,{correctNetworkId:"0x13881",nodeUri:""},o.createElement(_,{gatewayAddress:t.gatewayAddress}))))},E={sidebar_position:4},N="Demo",A={unversionedId:"catalog/demo",id:"catalog/demo",title:"Demo",description:"This demo is based in the code of the Example section",source:"@site/docs/catalog/demo.md",sourceDirName:"catalog",slug:"/catalog/demo",permalink:"/docs/catalog/demo",draft:!1,editUrl:"https://github.com/nevermined-io/docs/tree/main/docs/catalog/demo.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Example",permalink:"/docs/catalog/example"},next:{title:"Getting started",permalink:"/docs/catalog/core/"}},x={},M=[{value:"Workflow example",id:"workflow-example",level:2},{value:"View",id:"view",level:2}],T={toc:M};function S(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},T,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"demo"},"Demo"),(0,i.kt)("p",null,"This demo is based in the code of the ",(0,i.kt)("a",{parentName:"p",href:"/docs/catalog/example"},"Example")," section"),(0,i.kt)("h2",{id:"workflow-example"},"Workflow example"),(0,i.kt)("p",null,"The example included in the template covers the most used functionalities to work with NFT1155."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Requirements:")," The accounts wallet used for the example need to have ",(0,i.kt)("inlineCode",{parentName:"p"},"Matic")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"USDC")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Connect the wallet"),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("inlineCode",{parentName:"li"},"Mint")," button and approve transactions and sign authorization in the wallet."),(0,i.kt)("li",{parentName:"ol"},"As an owner once the token is minted the ",(0,i.kt)("inlineCode",{parentName:"li"},"Mint")," button will change to ",(0,i.kt)("inlineCode",{parentName:"li"},"Download NFT"),"."),(0,i.kt)("li",{parentName:"ol"},"Click in ",(0,i.kt)("inlineCode",{parentName:"li"},"Download NFT")," to get the example asset (in this case is a JSON file example)"),(0,i.kt)("li",{parentName:"ol"},"Change the account in the wallet"),(0,i.kt)("li",{parentName:"ol"},"Click in ",(0,i.kt)("inlineCode",{parentName:"li"},"Buy")," button and approve transactions and sign authorization in the wallet"),(0,i.kt)("li",{parentName:"ol"},"As a buyer once the token is bought the ",(0,i.kt)("inlineCode",{parentName:"li"},"Buy")," button will change to ",(0,i.kt)("inlineCode",{parentName:"li"},"Download NFT")),(0,i.kt)("li",{parentName:"ol"},"Repeat the step 4")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Warning:")," The data is not persistent, once that the browser is reloaded the workflow example starts\nfrom the beginning again"),(0,i.kt)("h2",{id:"view"},"View"),(0,i.kt)(r.Z,{fallback:(0,i.kt)("div",null,"Loading demo..."),mdxType:"BrowserOnly"},(()=>(0,i.kt)(C,{mdxType:"Demo"}))))}S.isMDXComponent=!0},88677:()=>{},62808:()=>{},9114:()=>{},74487:()=>{},46601:()=>{},89214:()=>{},71922:()=>{},2363:()=>{},96419:()=>{},56353:()=>{},69386:()=>{},31616:()=>{},69862:()=>{},40964:()=>{}}]);